<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>me@four oh four - setup and use ssh key pairs auth</title>
    <link rel="stylesheet" type="text/css" href="/assets/stylesheet.css" media="screen">
    <link href="/assets/favicon.ico" rel="shortcut icon">
    <link href="/assets/favicon.ico" rel="icon">
    <meta name="generator" content="nanoc 3.2.4">
  </head>
  <body>
    <div id="main">
        <div id="main-top-div">
        
        
                <a href="/">i update me everyday</a>
                |
                
                <a href="/blog/"></a>
                |
                
                <a href="/blog/2012-06-06-ssh-key/">setup and use ssh key pairs auth</a>
                
                
        
        <hr>
        </div>

        <p class="created_at">Wed Jun 6 2012</p>
      <h3 style="color:grey;">配置和使用ssh key auth驗證登陸</h3>
<hr />
<ul style="vertical-align:middle;">
	<li>客戶機器為 client_server</li>
	<li>需要提供登陸的服務器為 host_server</li>
	<li>在client_server和 host_server 上都有 local_conn_bot 用戶，家目錄為${HOME}</li>
</ul>
<h4 style="color:darkblue;">第一步 @client_server</h4>
<ul>
	<li>local_conn_bot@client_server $ ssh-keygen -t rsa -C local_conn_bot@localbox.me -f ${HOME}/.ssh/2012-local_conn_bot -P
	<ul>
		<li>[如果為系統用戶，可以直接回車設置2012-local_conn_bot這個key的passphrase為空]</li>
	</ul></li>
</ul>
<ul>
	<li>生成的key文件包括 2012-local_conn_bot 和 2012-local_conn_bot.pub</li>
</ul>

	<ul>
		<li>- 2012-local_conn_bot 文件為私匙，必須安全保存，不要存放到任何公用服務器上</li>
		<li>- 2012-local_conn_bot.pub 為公匙，是提供給host_server或者其它需要登陸的server的驗證文件</li>
	</ul><p>o 權限設置</p>

	<ul>
		<li>local_conn_bot@client_server $ chmod 700 ${HOME}/.ssh</li>
		<li>local_conn_bot#client_server $ chmod 400 ${HOME}/.ssh/2012-local_conn_bot*</li>
	</ul><h4 style="color:darkblue;">第二步 @host_server</h4>

	<ul>
		<li>local_conn_bot@host_server $ mkdir -p ${HOME}/.ssh &amp;&amp; chmod 700 ${HOME}/.ssh</li>
	</ul>
	<ul>
		<li>粘貼, scp或者其它方式append(追加)剛才的私匙 2012-local_conn_bot 內容到 ${HOME}/.ssh/auth_keys<br />
**（如果沒有${HOME}/.ssh/auth_keys) 可以直接 @client_server 執行</li>
	</ul>
	<ul>
		<li>local_conn_bot@client_server$ scp ${HOME}/.ssh/2012-local_conn_bot.pub host_server:${HOME}/.ssh/auth_keys</li>
		<li>local_conn_bot@host_server$ chmod 400 ${HOME}/.ssh/auth_keys</li>
	</ul><h4 style="color:darkblue;">第三步測試和dbug</h4>

	<ul>
		<li>local_conn_bot@client_server$ ssh host_server uptime ### 測試</li>
		<li>local_conn_bot@client_server$ ssh -vvv host_server uptime ### debug</li>
	</ul><h4 style="color:darkblue;">第四步可選 設置 client_server用戶的 ssh_config以使用多套key and or 配置</h4>

	<ul>
		<li>local_conn_bot@client_server$ cat ~/.ssh/config</li>
	</ul><p><code class="language-ruby"></p>

	<ol>
		<li><del>-</del> start of sample ssh config<br />
Host host_server_01<br />
        Hostname 192.168.2.1<br />
Host 30.20.10.0<br />
        Port 28<br />
        IdentityFile ~/.ssh/temp-local_conn_bot<br />
Host *<br />
        User local_conn_bot<br />
        ForwardAgent yes<br />
        Port 22<br />
        IdentityFile ~/.ssh/2012-local_conn_bot<br />
        UsePrivilegedPort no<br />
        ServerAliveInterval 240<br />
        ServerAliveCountMAx 9999</li>
		<li><del>-</del> end of sample ssh config<br />
</code></li>
	</ol>
    </div>
    <div id="sidebar">
      <h2>Be there</h2>
      <ul>
        <li><a href="/blog/">log</a></li>
        <li><a href="/">home</a></li>
      </ul>
      <h2>Read it</h2>
      <ul>
        <li><a href="http://docs.python.org/library/index.html">python doc</a></li>
        <li><a href="http://git-scm.com/documentation">git doc</a></li>
        <li><a href="http://safaribooksonline.com/">safaribooks</a></li>
        <li><a href="/txt/unixtoolbox.txt">basic commands</a></li>
      </ul>
      <h2>Use tools</h2>
      <ul>
        <li><a href="http://goo.gl/">url shortener</a></li>
        <li><a href="http://time.is/">localtime</a></li>
        <li><a href="https://www.google.com/finance?q=CURRENCY%3AUSDEUR&hl=en">currency ex rate</a></li>
        <li><a href="http://ttyn.github.com/InstaList/">checklist</a></li>
      </ul>
      <h2>Do that</h2>
      <ul>
        <li>ego depletion</li>
      </ul>
      <div id="div_update">Wed June 06, 2012 @17:25:44 CST</div>
    </div>

<!-- BEGIN google analytics --> 
<script type="text/javascript">  
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-7206667-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- END google analytics -->
  </body>
</html>
